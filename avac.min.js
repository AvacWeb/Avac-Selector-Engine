/* 
* Avac CSS Selector Engine. 
* Created by LGforum @ AvacWeb (avacweb.com)
* AvacWeb Copyright 2011-2012
* All Right Reserved.
* No unauthorized distrubution or copying.
*/
(function(){function p(a){return a.match(/(?:#[\w\d_-]+)|(?:\.[\w\d_-]+)|(?:\[\w+(?:[\$\*\^!\|~=]?=["']?.+["']?)?\])|(?:[\>\+~])|\w+|\s|(?::[\w-]+(?:\([^\)]+\))?)/g)||[]}function o(a){var b={id:/^#[^\>\+\.\s\[:~]+$/,"class":/^\.[^\>\+\.\s\[:\(~]+$/,tag:/^[^\>\+\.\s\[:="'\(~]+$/,rel:/^\>|\+|~$/,attr:/^\[\w+(?:[\$\*\^!\|~]?=["']?.+["']?)?\]$/,changer:/^:(?:eq|gt|lt|first|last|odd|even|nth)(?:\(\d+\))?$/,pseudo:/^:[\w\-]+(?:\(.+\))?$/,space:/^\s+$/},c;for(c in b)if(b[c].test(a))return c;return!1}function r(a,b){if(!b.querySelectorAll)return!1;try{return b.querySelectorAll(a)}catch(c){return!1}}function g(a,b,c){for(var d=0,e=[],g=a.length;d<g;d++){var h=a[d],f=c(h);b?f&&e.push(h):e=e.concat(f)}return e}function k(a,b,c){for(var d=[],e;e=a[b];)d.push(e),b+=c;return d}[].indexOf||(Array.prototype.indexOf=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1});var j;try{Array.prototype.slice.call(document.getElementsByTagName("html")),j=function(a){return Array.prototype.slice.call(a)}}catch(s){j=function(a){if(a instanceof Object)return Array.prototype.slice.call(a);l=a.length;ret=[];for(i=0;i<l;i++)ret.push(a[i]);return ret}}var e=function(a,b){if(!a||/^\s*$/.test(a)||!a.charAt)return[];var a=a.replace(/^\s+|\s+$/,"").replace(/\s?([\+~\>])\s?/g," $1"),c=[document];if(b&&b.nodeType&&(b.nodeType==1||b.nodeType==9))c=[b];var d=r(a,c[0]);if(d!=false)return d;d=/.*(?!(?:\(|\[).*#.+(?:\)|\]))(?:[\w\d]+|\s)#([\w\d_-]+).*/g;if(d.test(a)){c=[document.getElementById(a.replace(d,"$1"))];a=a.substr(d.lastIndex)}for(var d=p(a),n=0,j=d.length,h=[],d=g(d,false,function(a){return[{text:a,type:o(a)}]});n<j;n++){if(c.length==0)return[];var f=d[n],k=d[n+1];if(!f.type)throw Error("Invalid Selector: "+f.text);if(f.type!="space"&&k)h.push(f);else{f.type!="space"&&f.type!="changer"&&h.push(f);var q=h.shift(),c=g(c,false,function(a){return e.getters[q.type](a,q.text)});if(f.type=="changer"){f=f.text.match(/^:\w+|\s*['"]?(\d+)['"]?\s*?/g);c=e.changers[f[0]](c,f[1])}if(h.length){for(var m=0,f=h.length;m<f;m++)c=g(c,true,function(a){return e.filters[h[m].type](a,h[m].text)});m=0}h=[]}}return c};e.getters={id:function(a,b){return a.getElementById?[a.getElementById(b.substr(1))]:[document.getElementById(b.substr(1))]},"class":function(a,b){return a.getElementsByClassName?j(a.getElementsByClassName(b.substr(1))):g(a.all?a.all:a.getElementsByTagName("*"),true,function(a){return e.filters["class"](a,b)})},tag:function(a,b){return j(a.getElementsByTagName(b))},attr:function(a,b){return g(a.all?a.all:a.getElementsByTagName("*"),true,function(a){return e.filters.attr(a,b)})},rel:function(a,b){if(/\+|~/.test(b))a=a.parentNode;return g(a.childNodes,true,function(a){return e.filters.rel(a,b)})},pseudo:function(a,b){return g(a.all?a.all:a.getElementsByTagName("*"),true,function(a){return e.filters.pseudo(a,b)})}};e.filters={id:function(a,b){return a.id&&a.id===b.substr(1)},"class":function(a,b){return a.className&&RegExp("(^|\\s)"+b.substr(1)+"(\\s|$)").test(a.className)},tag:function(a,b){return a.tagName&&a.tagName.toLowerCase()===b.toLowerCase()},attr:function(a,b){var b=b.replace(/^\[|\]$/g,""),c=b.match(/(?:[^\|\^\*\$!~=]+)|(?:[\|\^\*\$!~=]?=)|(?:['"]?.+['"]?$)/g);c[2]&&(c[2]=c[2].replace(/^['"]|['"]$/g,""));var d=a.getAttribute?a.getAttribute(c[0]):a.attributes.getNamedItem(c[0]);if(!c[1]||!d)return d;switch(c[1]){case "==":case "=":return d===c[2];case "^=":case "|=":return d.indexOf(c[2])===0;case "$=":return RegExp(c[2]+"$").test(d);case "*=":case "~=":return d.indexOf(c[2])!=-1;case "!=":return d!=c[2]}return false},rel:function(a,b){switch(b){case "+":for(var c=a.previousElementSibling||a.previousSibling;c&&c.nodeType!=1;)c=c.previousSibling;return nodes.indexOf(c)!=-1;case "~":for(;a=a.previousSibling;)if(nodes.indexOf(a)!=-1)return true;break;case ">":return nodes.indexOf(a.parentElement||a.parentNode)!=-1}return false},pseudo:function(a,b){var c=b.match(/^:([\w-]+)|\s*['"]?[^\(\)]+['"]?\s*?/g);return e.pseudo_filter[c[0].substr(1)](a,c[1])}};e.pseudo_filter={"first-child":function(a){for(;a=a.previousSibling;)if(a.nodeType==1)return false;return true},"last-child":function(a){for(;a=a.nextSibling;)if(a.nodeType==1)return false;return true},hidden:function(a){var b=a.style;return a.type==="hidden"||b&&b.display==="none"||b&&b.visibility==="hidden"},contains:function(a,b){return(a.textContent||a.innerText||a.innerHTML.replace(/\<\/?[^\>]+>/g,"")).indexOf(b)!=-1},notcontains:function(a,b){return!this.contains(a,b)},"only-child":function(a){return this["first-child"](a)&&this["last-child"](a)},empty:function(a){return!a.hasChildNodes()},not:function(a,b){return e.self(b,a.parentNode).indexOf(a)==-1},has:function(a,b){return e.self(b,a).length>0},nothas:function(a,b){return!this.has(a,b)},selected:function(a){return a.selected},visible:function(a){return!this.hidden(a)},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},enabled:function(a){return!a.disabled},disabled:function(a){return a.disabled},checkbox:function(a){return a.type==="checkbox"},text:function(a){return a.type==="text"},header:function(a){return/h\d/i.test(a.nodeName)},radio:function(a){return a.type==="radio"},checked:function(a){return a.checked},parent:function(a){return a.hasChildNodes()}};e.changers={":eq":function(a,b){return[a[parseInt(b)]]},":gt":function(a,b){return a.slice(parseInt(b))},":lt":function(a,b){return a.slice(0,parseInt(b))},":first":function(a){return[a[0]]},":last":function(a){return[a[a.length-1]]},":odd":function(a){return k(a,0,2)},":even":function(a){return k(a,1,2)},":nth":function(a,b){return k(a,parseInt(b)-1,parseInt(b))}};e.self=e;e.filter=function(a,b){var c=o(b);return g(a,true,function(a){return e.filters[c](a,b)})};e.match=function(a,b){for(var c=p(b),d=0,g=c.length;d<g;d++){var j=o(c[d]);if(!e.filters[j](a,c[d]))return false}return true};window.$avac=e})();