/**
 * Avac Selector Engine
 * CSS3 selector engine.
 *
 * Copyright 2011-2013 AvacWeb (avacweb.com)
 * Released under the MIT and GPL Licenses.
 */
(function(){function j(a,b,c){for(var e=0,d=[],j=a.length;e<j;e++){var g=a[e],h=c(g);switch(b){case "f":h&&d.push(g);break;case "m":d=d.concat(h);break;case "r":d.push(h)}}return d}function q(a){return a.length?a.push?a:g(a):1==a.nodeType?[a]:[document]}function l(a,b,c){for(var d=[],f;f=a[b];)d.push(f),b+=c;return d}try{var g=function(a){return Array.prototype.slice.call(a)};g(document.getElementsByTagName("head"))}catch(r){g=function(a){return a instanceof Object?Array.prototype.slice.call(a):j(a,"r",function(a){return a})}}var d=function(a,b){if(!a||d.regex.space.test(a)||!a.charAt)return[];a=a.replace(/^\s+|\s+$/,"").replace(/\s?([\+~\>])\s?/g," $1");var c=b?q(b):[document],e=0,f=[],g;g=a.match(/(?:#[\w\d_-]+)|(?:\.[\w\d_-]+)|(?:\[\w+(?:[\$\*\^!\|~=]?=["']?.+["']?)?\])|(?:[\>\+~])|\w+|\s|(?::[\w-]+(?:\([^\)]+\))?)/g)||[];g=j(g,"r",function(a){var b;a:{for(b in d.regex)if(d.regex[b].test(a))break a;b=!1}return{text:a,type:b}});for(var l=g.length;e<l;e++){if(0==c.length)return[];var h=g[e],n=g[e+1];if(!h.type)throw Error("Invalid Selector: "+h.text);if("space"!=h.type&&n)f.push(h);else{"space"!=h.type&&"changer"!=h.type&&f.push(h);var p=f.shift();p&&(c=j(c,"m",function(a){return a?d.getters[p.type](a,p.text):[]}));for(var k=0,n=f.length;k<n;k++)if("changer"===f[k].type)var m=d.regex.changer.exec(f[k].text),c=d.changers[m[1]](c,parseInt(m[2]));else c=j(c,"f",function(a){return a?d.filters[f[k].type](a,f[k].text):!1});"changer"==h.type&&(m=d.regex.changer.exec(h.text),c=d.changers[m[1]](c,parseInt(m[2])));f=[]}}return c};d.regex={id:/^#[\w\d-]+$/,Class:/^\.[\w\d-]+$/,tag:/^\w+$/,rel:/^\>|\+|~$/,attr:/^\[(\w+(?:-\w+)?)(?:([\$\*\^!\|~]?=)(.+?))?\]$/,changer:/^:(eq|gt|lt|first|last|odd|even|nth)(?:\((\d+)\))?$/,pseudo:/^:([\w\-]+)(?:\((.+?)\))?$/,space:/^\s+$/};d.getters={id:function(a,b){b=b.substr(1);return a.getElementById?[a.getElementById(b)]:[document.getElementById(b)]},Class:function(a,b){return a.getElementsByClassName?g(a.getElementsByClassName(b.substr(1))):j(a.all?a.all:a.getElementsByTagName("*"),"f",function(a){return d.filters.Class(a,b)})},tag:function(a,b){return g(a.getElementsByTagName(b))},attr:function(a,b){return j(a.all?a.all:a.getElementsByTagName("*"),"f",function(a){return d.filters.attr(a,b)})},rel:function(a,b){switch(b){case "+":for(var c=a.nextElementSibling||a.nextSibling;c&&1!==c.nodeType;)c=c.nextSibling;return[c];case ">":return j(a.childNodes,"f",function(a){return 1===a.nodeType});case "~":return j(a.parentNode.childNodes,"f",function(b){return d.filters.rel(b,"~",a)})}},pseudo:function(a,b){return j(a.all?a.all:a.getElementsByTagName("*"),"f",function(a){return d.filters.pseudo(a,b)})}};d.filters={id:function(a,b){return a.id&&a.id===b.substr(1)},Class:function(a,b){return a.className&&RegExp("(^|\\s)"+b.substr(1)+"(\\s|$)").test(a.className)},tag:function(a,b){return a.tagName&&a.tagName.toLowerCase()===b.toLowerCase()},attr:function(a,b){var c=d.regex.attr.exec(b),e=a.getAttribute?a.getAttribute(c[1]):a.attributes.getNamedItem(c[1]);if(!c[2]||!e)return!!e;if(c[2]&&c[3]){var f=c[3].replace(/^['"]|['"]$/g,"");switch(c[2]){case "==":case "=":return e===f;case "^=":case "|=":return 0===e.indexOf(f);case "$=":return RegExp(f+"$").test(e);case "*=":return-1!=e.indexOf(f);case "~=":return e.match(RegExp("\\b"+f+"\\b"));case "!=":return e!=f}}return!1},rel:function(a,b,c){switch(b){case "+":for(a=a.previousElementSibling||a.previousSibling;a&&1!=a.nodeType;)a=a.previousSibling;return a===c;case "~":return a!==c&&a.parentNode===c.parentNode;case ">":return a.parentNode===c}return!1},pseudo:function(a,b){var c=b.replace(d.regex.pseudo,"$1"),e=b.replace(d.regex.pseudo,"$2");return d.pseudo_filter[c](a,e)}};d.pseudo_filter={"first-child":function(a){for(;a=a.previousSibling;)if(1==a.nodeType)return!1;return!0},"last-child":function(a){for(;a=a.nextSibling;)if(1==a.nodeType)return!1;return!0},hidden:function(a){var b=a.style;return"hidden"===a.type||b&&"none"===b.display||b&&"hidden"===b.visibility},contains:function(a,b){return-1!=(a.textContent||a.innerText||a.innerHTML.replace(/<.*?>/g,"")).indexOf(b)},notcontains:function(a,b){return!this.contains(a,b)},"only-child":function(a){return this["first-child"](a)&&this["last-child"](a)},empty:function(a){return!a.hasChildNodes()},not:function(a,b){return-1==d(b).indexOf(a)},has:function(a,b){return 0<d(b,a).length},nothas:function(a,b){return!this.has(a,b)},selected:function(a){return a.selected},visible:function(a){return!this.hidden(a)},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},enabled:function(a){return!a.disabled},disabled:function(a){return a.disabled},checkbox:function(a){return"checkbox"===a.type},text:function(a){return"text"===a.type},header:function(a){return/h\d/i.test(a.nodeName)},radio:function(a){return"radio"===a.type},checked:function(a){return a.checked}};d.changers={eq:function(a,b){return a[b]?[a[b]]:[]},gt:function(a,b){return a.slice(b)},lt:function(a,b){return a.slice(0,b)},first:function(a){return[a[0]]},last:function(a){return[a[a.length-1]]},odd:function(a){return l(a,0,2)},even:function(a){return l(a,1,2)},nth:function(a,b){return l(a,b-1,b)}};window.$avac=document.querySelectorAll?function(a,b){b=b?q(b):[document];return j(b,"m",function(b){return g(b.querySelectorAll(a))})}:d})();
