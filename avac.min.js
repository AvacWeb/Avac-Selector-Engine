/**
 * Avac Selector Engine
 * CSS3 selector engine.
 *
 * Copyright 2011-2013 AvacWeb (avacweb.com)
 * Released under the MIT and GPL Licenses.
 */
(function(s){function g(a,b,c){var e={f:"filter",m:"map",a:"forEach"}[b],d=0,f=[],g=a.length;if(e&&a[e])return a[e].call(a,c);for(;d<g;d++){var e=a[d],p=c.call(a,e,d,a);switch(b){case "f":p&&f.push(e);break;case "c":f=f.concat(k(p));break;case "m":f.push(p)}}return f}function k(a){return Array.prototype.slice.call(a)}function r(a){return a.all?a.all:a.getElementsByTagName("*")}function l(a,b,c){for(var e=[],d;d=a[b];)e.push(d),b+=c;return e}try{k({0:1,length:1})}catch(u){k=function(a){return g(a,"m",function(a){return a})}}var f=function(a,b){if(!a||this.regex.space.test(a)||!a.charAt)return[];a=a.replace(/^\s+|\s+$/,"").replace(/\s?([\+~\>])\s?/g," $1");var c=0,e=[],d=[s],n;b&&(b instanceof Array?d=b:b.length?d=k(d):1===b.nodeType&&(d=[b]));if(s.querySelectorAll)try{return g(d,"c",function(b){return k(b.querySelectorAll(a))})}catch(r){}n=g(a.match(/(?:#[\w\d_-]+)|(?:\.[\w\d_-]+)|(?:\[(\w+(?:-\w+)?)(?:([\$\*\^!\|~\/]?=)(.+?))?\])|(?:[\>\+~])|\w+|\s|(?::[\w-]+(?:\([^\)]+\))?)/g)||[],"m",function(a){var b;a:{for(b in f.regex)if(f.regex[b].test(a))break a;b=!1}return{text:a,type:b}});for(var p=n.length;c<p;c++){if(0===d.length||0===n.length)return[];var h=n[c];if(!h.type)throw Error("Invalid Selector: "+h.text);if("space"!==h.type&&n[c+1])e.push(h);else{"space"!==h.type&&"changer"!==h.type&&e.push(h);for(var l=e.shift(),m=0,t=e.length,d=g(d,"c",function(a){return a?f.getters[l.type](a,l.text):[]});m<t;m++)if("changer"===e[m].type)var q=this.regex.changer.exec(e[m].text),d=this.changers[q[1]](d,parseInt(q[2]));else d=g(d,"f",function(a){return a?f.filters[e[m].type](a,e[m].text):!1});"changer"==h.type&&(q=this.regex.changer.exec(h.text),d=this.changers[q[1]](d,parseInt(q[2])));e=[]}}return d};f.regex={id:/^#[\w\d-]+$/,Class:/^\.[\w\d-]+$/,tag:/^\w+$/,rel:/^\>|\+|~$/,attr:/^\[(\w+(?:-\w+)?)(?:([\$\*\^!\|~\/]?=)(.+?))?\]$/,changer:/^:(eq|gt|lt|first|last|odd|even|nth)(?:\((\d+)\))?$/,pseudo:/^:([\w\-]+)(?:\((.+?)\))?$/,space:/^\s+$/};f.getters={id:function(a,b){b=b.replace("#","");return a.getElementById?[a.getElementById(b)]:[s.getElementById(b)]},Class:function(a,b){b=b.replace(".","");return a.getElementsByClassName?k(a.getElementsByClassName(b)):g(r(a),"f",function(a){return f.filters.Class(a,b)})},tag:function(a,b){return k(a.getElementsByTagName(b))},attr:function(a,b){return g(r(a),"f",function(a){return f.filters.attr(a,b)})},rel:function(a,b){switch(b){case "+":for(var c=a.nextElementSibling||a.nextSibling;c&&1!==c.nodeType;)c=c.nextSibling;return[c];case ">":return g(a.childNodes,"f",function(a){return 1===a.nodeType});case "~":return a.parentNode&&(c=a.parentNode.children)?g(c,"f",function(b){return f.filters.rel(b,"~",a)}):[]}},pseudo:function(a,b){return g(r(a),"f",function(a){return f.filters.pseudo(a,b)})}};f.filters={id:function(a,b){return a.id&&a.id===b.replace("#","")},Class:function(a,b){return a.className&&RegExp("(^|\\s)"+b.replace(".","")+"(\\s|$)").test(a.className)},tag:function(a,b){return a.tagName&&a.tagName.toLowerCase()===b.toLowerCase()},attr:function(a,b){var c=f.regex.attr.exec(b),e=a.getAttribute?a.getAttribute(c[1]):a.attributes.getNamedItem(c[1]);if(!c[2]||!e)return!!e;if(c[2]&&c[3]){var d=c[3].replace(/^['"]|['"]$/g,"");switch(c[2]){case "==":case "=":return e===d;case "^=":case "|=":return 0===e.indexOf(d);case "$=":return e.indexOf(d)===e.length-d.length;case "*=":return-1!=e.indexOf(d);case "~=":return e.match(RegExp("\\b"+d+"\\b"));case "!=":return e!=d;case "/=":return c=d.match(/\s(\w+)$/)||["",""],d=d.replace(/\\/g,"\\\\").replace(c[0],""),RegExp(d,c[1]).test(e)}}return!1},rel:function(a,b,c){switch(b){case "+":for(a=a.previousElementSibling||a.previousSibling;a&&1!=a.nodeType;)a=a.previousSibling;return a===c;case "~":return a!==c&&a.parentNode===c.parentNode;case ">":return a.parentNode===c}return!1},pseudo:function(a,b){var c=b.replace(f.regex.pseudo,"$1"),e=b.replace(f.regex.pseudo,"$2");return f.pseudo_filters[c](a,e)}};f.pseudo_filters={"first-child":function(a,b){for(;a=a.previousSibling;)if(1==a.nodeType)return!1;return!0},"last-child":function(a,b){for(;a=a.nextSibling;)if(1==a.nodeType)return!1;return!0},hidden:function(a,b){return!a.style||"none"!==a.style.display&&"hidden"!==a.style.visibility?"hidden"===a.type:!0},contains:function(a,b){return-1!=(a.textContent||a.innerText||a.innerHTML.replace(/<.*?>/g,"")).indexOf(b)},notcontains:function(a,b){return!this.contains(a,b)},"only-child":function(a,b){return this["first-child"](a)&&this["last-child"](a)},empty:function(a,b){return!a.hasChildNodes()},not:function(a,b){return-1==f(b).indexOf(a)},has:function(a,b){return 0<f(b,a).length},nothas:function(a,b){return!this.has(a,b)},selected:function(a,b){return a.selected},visible:function(a,b){return!this.hidden(a)},input:function(a,b){return/input|select|textarea|button/i.test(a.nodeName)},enabled:function(a,b){return!a.disabled},disabled:function(a,b){return a.disabled},checkbox:function(a,b){return"checkbox"===a.type},text:function(a,b){return"text"===a.type},header:function(a,b){return/h\d/i.test(a.nodeName)},radio:function(a,b){return"radio"===a.type},checked:function(a,b){return a.checked}};f.changers={eq:function(a,b){return a[b]?[a[b]]:[]},gt:function(a,b){return a.slice(b)},lt:function(a,b){return a.slice(0,b)},first:function(a,b){return[a[0]]},last:function(a,b){return[a[a.length-1]]},odd:function(a,b){return l(a,0,2)},even:function(a,b){return l(a,1,2)},nth:function(a,b){return l(a,b-1,b)}};window.$avac=function(a,b){return f.call(f,a,b)};$avac.add_pseudo=function(a,b){f.pseudo_filters[a]=b}})(document);
